# syntax=docker/dockerfile:1.4.1

# generated by dockerfile_gen.py

# DOCKER_BUILDKIT=1 docker build ...

FROM ubuntu:23.04

SHELL ["/bin/bash", "-c"]

RUN apt-get update

RUN apt install sudo adduser

RUN adduser runner && \
    echo '%runner ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers
USER runner

RUN sudo ln -sf /usr/share/zoneinfo/Asia/Tokyo /etc/localtime
ENV DEBIAN_FRONTEND=noninteractive DEBCONF_NONINTERACTIVE_SEEN=true

RUN sudo apt install -y wget unzip xz-utils curl

RUN sudo mkdir /judge --mode=777

WORKDIR /judge


RUN <<EOF

sudo apt install -y git

wget https://github.com/conda-forge/miniforge/releases/download/23.1.0-1/Mambaforge-23.1.0-1-Linux-x86_64.sh
bash Mambaforge-23.1.0-1-Linux-x86_64.sh -b

source ~/mambaforge/bin/activate
mamba install -y \
numpy==1.24.3 \
numba==0.57.0 \
scipy==1.10.1 \
networkx==3.1 \
sympy==1.11.1 \
sortedcontainers==2.4.0 \
more-itertools==9.1.0 \
shapely==2.0.1 \
bitarray==2.7.3 \
pulp==2.7.0 \
mpmath==1.3.0 \
pandas==2.0.0 \
scikit-learn==1.2.2 \
scikit-learn-intelex==2023.0.2 \
ortools-python==9.6 \
cppyy==2.4.2 \
polars==0.16.18 \
lightgbm==3.3.5 \
cython==0.29.34 \
graphblas==7.4.4 \
pytorch==2.0.0 
pip install git+https://github.com/not522/ac-library-python

EOF



COPY --chmod=777 run.bash /tmp/run.bash
